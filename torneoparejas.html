p<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="manifest" href="manifest.json">
<link rel="icon" href="icono_torneo.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="icono_torneo.ico">
<meta name="theme-color" content="#000000">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Torneo de los Pibes</title>
  <style>
    :root {
      --bg: #ffffff;
      --text: #000000;
      --accent: #3333cc;
      --menu-bg: #f0f0f0;
    }

    [data-theme="dark"] {
      --bg: #121212;
      --text: #ffffff;
      --accent: #3399ff;
      --menu-bg: #1e1e1e;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      background-color: var(--bg);
      color: var(--text);
      font-size: 1.3rem;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background: var(--menu-bg);
      border-bottom: 1px solid #ccc;
    }

    .hamburger {
      font-size: 24px;
      cursor: pointer;
    }

    .title {
      font-weight: bold;
    }

    .theme-toggle {
      width: 24px;
      height: 24px;
      background: linear-gradient(90deg, #fff 50%, #000 50%);
      border-radius: 50%;
      border: 2px solid var(--text);
      cursor: pointer;
    }

    .menu {
      display: none;
      flex-direction: column;
      background: var(--menu-bg);
      position: absolute;
      top: 50px;
      left: 0;
      width: 200px;
      border: 1px solid #ccc;
    }

    .menu a {
      padding: 10px;
      text-decoration: none;
      color: var(--text);
      border-bottom: 1px solid #ccc;
    }

    main {
      padding: 1px 20px 100px;
      max-width: 800px;
      margin: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .section {
      display: none;
    }

    .active {
      display: block;
    }

    input {
  margin: 8px;
  padding: 14px;
  width: 260px;
  font-size: 0.8rem;
  text-align: center;
  border: 1px solid #ccc;
  border-radius: 6px;
  touch-action: manipulation;
}

    button {
  display: block;
  margin: 10px auto;
  padding: 10px 20px;
  font-size: 1.2rem; /* Letra más grande */
  background-color: #006400; /* Verde oscuro */
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.boton-rojo {
  background-color: #cc0000 !important; /* Rojo fuerte */
  color: white !important;
}

    .partido {
      margin: 8px 0;
      display: flex;
      justify-content: center;
      gap: 8px;
      align-items: center;
    }
    
    .partido {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 8px;
  align-items: center;
  margin: 12px 0;
  text-align: center;
}

.partido span {
  display: block;
  word-break: break-word;
  max-width: 130px;
  margin: 0 auto;
}
    

    .partido input {
      width: 40px;
      text-align: center;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 5px;
      text-align: center;
    }

    #form-jugadores {
      margin-top: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #partidos-lista,
#tabla-resultados {
  display: flex;
  flex-direction: column;
  align-items: center;
}

#tabla-resultados h3 {
  margin-bottom: 4px;
  margin-top: 24px;
}

#tabla-resultados table {
  margin-top: 8px;
}

#tabla-resultados h3 + table {
  margin-top: 4px;
}

#lista-rondas {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 16px;
  justify-items: center;
  align-items: start;
  margin-top: 20px;
  width: 100%;
}

.ronda-box {
  text-align: center;
  padding: 10px 5px;
  background: none;
  border: none;
  box-shadow: none;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

    footer {
  position: fixed;
  bottom: 0;
  width: 100%;
  text-align: center;
  padding: 4px 8px; /* menos espacio vertical (4px) y lateral (8px) */
  background: var(--menu-bg);
  color: var(--text);
  border-top: 1px solid #ccc;
  font-size: 13px; /* opcional: letra más chica */
  line-height: 1.2; /* opcional: ajusta el alto de línea */
}
  </style>
</head>
<body>
  <header>
    <div class="hamburger" onclick="toggleMenu()">☰</div>
    <div class="title">Torneo de los Pibes</div>
    <div class="theme-toggle" onclick="toggleTheme()"></div>
  </header>

  <div class="menu" id="menu">
    <a href="liga.html">LIGAS INDIVIDUALES</a>
    <a href="torneoparejas.html">TORNEOS POR PAREJAS ROTATIVAS</a>
    <a href="historial.html">HISTÓRICO ENTRE JUGADORES</a>
  </div>

  <main>
    <section id="jugadores" class="section active">
      <h2>Ingresá los jugadores</h2>
      <div id="form-jugadores"></div>
      <button onclick="agregarJugador()">+</button>
      <button onclick="generarRondas()">Generar Rondas</button>
    </section>

    <section id="rondas" class="section">
      <h2>Rondas Generadas</h2>
      <div id="lista-rondas"></div>
      <button onclick="mostrarSeccion('partidos');mostrarPartidos()">Ver partidos</button>
      <button onclick="mostrarSeccion('jugadores')">Volver</button>
    </section>

    <section id="partidos" class="section">
      <h2>Partidos</h2>
      <div id="partidos-lista"></div>
      <button onclick="mostrarSeccion('tabla');mostrarTabla()">Ver tabla</button>
      <button onclick="mostrarSeccion('rondas')">Volver</button>
    </section>

    <section id="tabla" class="section">
      <h2>Tabla de posiciones</h2>
      <div id="tabla-resultados"></div>
      <button onclick="mostrarSeccion('partidos')">Volver a partidos</button>
      <button onclick="guardarEnHistorial()" class="boton-historial">GUARDAR HISTORIAL</button>
      <button class="boton-rojo" onclick="confirmarReinicio()">Reiniciar torneo</button>
    </section>
  </main>

  <footer>Desarrollado con I.A.
Donaciones al ALIAS: sergiosainz.frances GRACIAS!
Mail: sergiosainz.proyectos@gmail.com</footer>

  <script>
const input = document.getElementById('jugadores');
const cont = document.getElementById('partidos-lista');
const tabla = document.getElementById('tabla-posiciones').querySelector('tbody');

function toggleMenu() {
  const menu = document.getElementById('menu');
  menu.style.display = (menu.style.display === 'flex') ? 'none' : 'flex';
}

function toggleTheme() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  document.documentElement.setAttribute('data-theme', currentTheme === 'dark' ? 'light' : 'dark');
}

function agregarJugador() {
  const contenedor = document.getElementById('form-jugadores');
  const input = document.createElement('input');
  input.type = 'text';
  input.placeholder = 'Nombre del jugador';
  contenedor.appendChild(input);
}

function generarInputs() {
  for (let i = 0; i < 6; i++) agregarJugador();
}

window.onload = generarInputs;

function generarRondas(jugadores) {
  const rondas = [];
  const usadas = new Set();

  const esPar = jugadores.length % 2 === 0;
  const maxRondas = esPar ? jugadores.length - 1 : jugadores.length;

  for (let i = 0; i < maxRondas; i++) {
    const ronda = [];
    const usadosEnRonda = new Set();

    for (let j = 0; j < jugadores.length; j++) {
      for (let k = j + 1; k < jugadores.length; k++) {
        const a = jugadores[j];
        const b = jugadores[k];
        const key = `${a}-${b}`;

        if (usadas.has(key) || usadosEnRonda.has(a) || usadosEnRonda.has(b)) continue;

        ronda.push([a, b]);
        usadas.add(key);
        usadosEnRonda.add(a);
        usadosEnRonda.add(b);
        break;
      }
    }

    rondas.push(ronda);
  }

  return rondas;
}

function mostrarRondas(rondas) {
  const historial = JSON.parse(localStorage.getItem('resultados') || '[]');
  cont.innerHTML = '';
  rondas.forEach((ronda, i) => {
    const div = document.createElement('div');
    div.innerHTML = `<strong>Ronda ${i + 1}</strong>` +
      ronda.map(([a, b]) => `<div>${a} + ${b}</div>`).join('');
    cont.appendChild(div);
  });
}

function mostrarPartidos(rondas) {
  const historial = JSON.parse(localStorage.getItem('resultados') || '[]');
  cont.innerHTML = '';
  rondas.forEach((ronda, i) => {
    const [a1, a2] = ronda[0] || [];
    const [b1, b2] = ronda[1] || [];
    const key = `ronda-${i}`;
    const resultado = historial.find(r => r.key === key) || {};
    const [g1, g2] = resultado.goles || [];

    cont.innerHTML += `
      <div class="partido">
        <span>${a1} + ${a2}</span>
        <div>
          <input type="number" min="0" value="${g1 ?? ''}" onchange="guardarResultado(${i}, 0, this.value)">
          <div>vs</div>
          <input type="number" min="0" value="${g2 ?? ''}" onchange="guardarResultado(${i}, 1, this.value)">
        </div>
        <span>${b1 && b2 ? `${b1} + ${b2}` : '<em>(Libre)</em>'}</span>
      </div>`;
  });
}

function guardarResultado(rondaIndex, equipoIndex, valor) {
  const historial = JSON.parse(localStorage.getItem('resultados') || '[]');
  const key = `ronda-${rondaIndex}`;
  let resultado = historial.find(r => r.key === key);
  if (!resultado) {
    resultado = { key, goles: [] };
    historial.push(resultado);
  }
  resultado.goles[equipoIndex] = parseInt(valor);
  localStorage.setItem('resultados', JSON.stringify(historial));
  mostrarTabla();
}

function mostrarTabla() {
  const jugadores = input.value.split(',').map(j => j.trim()).filter(j => j);
  const rondas = generarRondas(jugadores);
  const historial = JSON.parse(localStorage.getItem('resultados') || '[]');
  const tablaPosiciones = {};

  jugadores.forEach(j => {
    tablaPosiciones[j] = { pj: 0, pg: 0, pe: 0, pp: 0 };
  });

  rondas.forEach((ronda, i) => {
    const key = `ronda-${i}`;
    const resultado = historial.find(r => r.key === key);
    if (!resultado || resultado.goles.length < 2) return;

    const [[a1, a2], [b1, b2]] = ronda;
    const [g1, g2] = resultado.goles;

    if (!a1 || !a2 || !b1 || !b2) return;

    const equipoA = [a1, a2];
    const equipoB = [b1, b2];

    equipoA.forEach(j => tablaPosiciones[j].pj++);
    equipoB.forEach(j => tablaPosiciones[j].pj++);

    if (g1 > g2) {
      equipoA.forEach(j => tablaPosiciones[j].pg++);
      equipoB.forEach(j => tablaPosiciones[j].pp++);
    } else if (g1 < g2) {
      equipoB.forEach(j => tablaPosiciones[j].pg++);
      equipoA.forEach(j => tablaPosiciones[j].pp++);
    } else {
      equipoA.forEach(j => tablaPosiciones[j].pe++);
      equipoB.forEach(j => tablaPosiciones[j].pe++);
    }
  });

  const filas = Object.entries(tablaPosiciones).map(([jugador, stats]) => {
    const { pj, pg, pe, pp } = stats;
    const por_pj = pj;
    const por_pe = ((pe / pj) * 100).toFixed(1) + '%';
    const por_pp = ((pp / pj) * 100).toFixed(1) + '%';
    return { jugador, pj, pg, pe, pp, por_pj, por_pe, por_pp };
  });

  filas.sort((a, b) => b.pg - a.pg);

  tabla.innerHTML = filas.map((fila, i) => `
    <tr>
      <td>${i + 1}</td>
      <td>${fila.jugador}</td>
      <td>${fila.pj}</td>
      <td>${fila.pg}</td>
      <td>${fila.pe}</td>
      <td>${fila.pp}</td>
      <td>${fila.por_pj}</td>
      <td>${fila.por_pe}</td>
      <td>${fila.por_pp}</td>
    </tr>
  `).join('');
}

function guardarEnHistorial() {
  const tabla = document.getElementById('tabla-posiciones');
  const filas = tabla.querySelectorAll('tbody tr');
  const tipo = 'parejas';

  const historialGuardado = JSON.parse(localStorage.getItem('historial')) || [];

  const nuevoHistorial = Array.from(filas).map(fila => {
    const columnas = fila.querySelectorAll('td');
    return {
      tipo: tipo,
      posicion: columnas[0].innerText,
      nombre: columnas[1].innerText,
      pj: columnas[2].innerText,
      pg: columnas[3].innerText,
      pe: columnas[4].innerText,
      pp: columnas[5].innerText,
      por_pj: columnas[6].innerText,
      por_pe: columnas[7].innerText,
      por_pp: columnas[8].innerText
    };
  });

  const historialActualizado = historialGuardado.concat(nuevoHistorial);
  localStorage.setItem('historial', JSON.stringify(historialActualizado));
  alert("Historial guardado correctamente.");
}

function reiniciarResultados() {
  localStorage.removeItem('resultados');
  mostrarPartidos(generarRondas(input.value.split(',').map(j => j.trim()).filter(j => j)));
  mostrarTabla();
}
</script>
      
    
  

</body>
</html>
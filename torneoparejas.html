<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Torneo de Amigos</title>
  <link rel="stylesheet" href="estilos.css">
  <style>
    :root {
      --color-fondo: #f5f5f5;
      --color-texto: #333;
      --color-primario: #4CAF50;
    }

    body.dark {
      --color-fondo: #222;
      --color-texto: #eee;
      --color-primario: #81C784;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--color-fondo);
      color: var(--color-texto);
    }

    header {
      background-color: var(--color-primario);
      color: white;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    nav {
      display: none;
    }

    .menu.active nav {
      display: block;
    }

    .menu-btn {
      font-size: 24px;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
    }

    main {
      padding: 20px;
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    input, button {
      padding: 10px;
      margin: 5px 0;
    }

    button {
      cursor: pointer;
      background-color: var(--color-primario);
      border: none;
      color: white;
      border-radius: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    footer {
      text-align: center;
      padding: 10px;
      background-color: var(--color-primario);
      color: white;
      position: fixed;
      bottom: 0;
      width: 100%;
    }
  </style>
</head>
<body>
  <header>
    <h1>Torneo de Amigos</h1>
    <button class="menu-btn" onclick="toggleMenu()">â˜°</button>
    <nav>
      <button onclick="mostrarSeccion('jugadores')">Jugadores</button>
      <button onclick="mostrarSeccion('rondas')">Rondas</button>
      <button onclick="mostrarSeccion('tabla')">Tabla</button>
      <button onclick="toggleTheme()">ðŸŒ“</button>
    </nav>
  </header>

  <main>
    <section id="jugadores" class="section active">
      <h2>Agregar Jugadores</h2>
      <div id="form-jugadores"></div>
      <button onclick="agregarJugador()">+</button>
      <button onclick="procesarRondas()">Generar Rondas</button>
    </section>

    <section id="rondas" class="section">
      <h2>Rondas</h2>
      <div id="rondas-container"></div>
    </section>

    <section id="tabla" class="section">
      <h2>Tabla de Posiciones</h2>
      <div id="tabla-resultados"></div>
      <table id="tabla-posiciones">
        <thead>
          <tr>
            <th>#</th>
            <th>Jugador</th>
            <th>PJ</th>
            <th>PG</th>
            <th>PE</th>
            <th>PP</th>
            <th>% Jugados</th>
            <th>% Empates</th>
            <th>% Perdidos</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <footer>
    Desarrollado por SDD
  </footer>

  <script>
    function toggleMenu() {
      document.body.classList.toggle('menu');
    }

    function toggleTheme() {
      document.body.classList.toggle('dark');
    }

    function mostrarSeccion(id) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    function agregarJugador() {
      const contenedor = document.getElementById('form-jugadores');
      const input = document.createElement('input');
      input.type = 'text';
      input.placeholder = 'Nombre del jugador';
      contenedor.appendChild(input);
    }

    function procesarRondas() {
      const inputs = document.querySelectorAll('#form-jugadores input');
      const jugadores = Array.from(inputs).map(i => i.value.trim()).filter(j => j);
      if (jugadores.length < 4) {
        alert('IngresÃ¡ al menos 4 jugadores');
        return;
      }
      const rondas = generarRondas(jugadores);
      localStorage.setItem('jugadores', JSON.stringify(jugadores));
      localStorage.setItem('rondas', JSON.stringify(rondas));
      mostrarRondas(rondas);
      mostrarSeccion('rondas');
    }

    function generarRondas(jugadores) {
      const rondas = [];
      for (let i = 0; i < jugadores.length - 1; i++) {
        for (let j = i + 1; j < jugadores.length; j++) {
          rondas.push([jugadores[i], jugadores[j]]);
        }
      }
      return rondas;
    }

    function mostrarRondas(rondas) {
      const contenedor = document.getElementById('rondas-container');
      contenedor.innerHTML = '';
      rondas.forEach((partido, i) => {
        const div = document.createElement('div');
        div.innerHTML = `
          <strong>Partido ${i + 1}:</strong> ${partido[0]} vs ${partido[1]}<br>
          <button onclick="guardarResultado('${partido[0]}')">GanÃ³ ${partido[0]}</button>
          <button onclick="guardarResultado('Empate')">Empate</button>
          <button onclick="guardarResultado('${partido[1]}')">GanÃ³ ${partido[1]}</button>
        `;
        contenedor.appendChild(div);
      });
    }

    let historial = {};

    function guardarResultado(resultado) {
      historial[resultado] = (historial[resultado] || 0) + 1;
      localStorage.setItem('historial', JSON.stringify(historial));
      mostrarTabla();
    }

    function mostrarTabla() {
      const tabla = document.getElementById('tabla-posiciones').querySelector('tbody');
      tabla.innerHTML = '';

      const jugadores = JSON.parse(localStorage.getItem('jugadores') || '[]');
      const rondas = JSON.parse(localStorage.getItem('rondas') || '[]');
      const totalPartidos = rondas.length;
      const hist = JSON.parse(localStorage.getItem('historial') || '{}');

      jugadores.forEach((jugador, i) => {
        const jugados = Object.values(hist).reduce((acc, val) => acc + val, 0);
        const ganados = hist[jugador] || 0;
        const empates = hist['Empate'] || 0;
        const perdidos = jugados - ganados - empates;

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${i + 1}</td>
          <td>${jugador}</td>
          <td>${jugados}</td>
          <td>${ganados}</td>
          <td>${empates}</td>
          <td>${perdidos}</td>
          <td>${((jugados / totalPartidos) * 100).toFixed(1)}%</td>
          <td>${((empates / jugados) * 100 || 0).toFixed(1)}%</td>
          <td>${((perdidos / jugados) * 100 || 0).toFixed(1)}%</td>
        `;
        tabla.appendChild(row);
      });
    }

    window.onload = () => {
      const jugadores = JSON.parse(localStorage.getItem('jugadores') || '[]');
      jugadores.forEach(nombre => {
        const input = document.createElement('input');
        input.type = 'text';
        input.value = nombre;
        document.getElementById('form-jugadores').appendChild(input);
      });

      const rondas = JSON.parse(localStorage.getItem('rondas') || '[]');
      if (rondas.length) mostrarRondas(rondas);

      historial = JSON.parse(localStorage.getItem('historial') || '{}');
      mostrarTabla();
    };
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Torneo por Parejas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f1f1f1;
    }

    header, footer {
      background-color: #333;
      color: white;
      padding: 10px;
      text-align: center;
    }

    nav {
      background-color: #444;
      overflow: hidden;
    }

    nav a {
      float: left;
      display: block;
      color: #fff;
      text-align: center;
      padding: 10px 16px;
      text-decoration: none;
    }

    nav a:hover {
      background-color: #ddd;
      color: black;
    }

    main {
      padding: 20px;
    }

    h2 {
      color: #333;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      background-color: white;
    }

    table, th, td {
      border: 1px solid #aaa;
    }

    th, td {
      padding: 8px;
      text-align: center;
    }

    .form-group {
      margin-bottom: 10px;
    }

    .form-group input {
      padding: 5px;
      margin-right: 10px;
    }

    button {
      padding: 8px 16px;
      background-color: #28a745;
      border: none;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #218838;
    }
  </style>
</head>
<body>

  <header>
    <h1>Torneo por Parejas</h1>
  </header>

  <nav>
    <a href="index.html">Inicio</a>
    <a href="liga.html">Liga</a>
    <a href="torneoparejas.html">Parejas</a>
    <a href="historial.html">Historial</a>
  </nav>

  <main>
    <section>
      <h2>Cargar Resultado</h2>
      <div class="form-group">
        <input type="text" id="pareja1" placeholder="Pareja 1">
        <input type="number" id="puntos1" placeholder="Puntos">
      </div>
      <div class="form-group">
        <input type="text" id="pareja2" placeholder="Pareja 2">
        <input type="number" id="puntos2" placeholder="Puntos">
      </div>
      <button onclick="cargarResultado()">Cargar</button>
      <button onclick="guardarHistorial()">Guardar Historial</button>
    </section>

    <section>
      <h2>Tabla por Parejas</h2>
      <table id="tabla-parejas">
        <thead>
          <tr>
            <th>Pareja</th>
            <th>Jugados</th>
            <th>Ganados</th>
            <th>Empatados</th>
            <th>Perdidos</th>
            <th>Puntos</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section>
      <h2>Tabla Individual (referencial)</h2>
      <table id="tabla-individual">
        <thead>
          <tr>
            <th>Jugador</th>
            <th>Puntos</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <footer>
    Desarrollado por SDD
  </footer>

  <script>
    const tablaParejas = {};

    function cargarResultado() {
      const pareja1 = document.getElementById("pareja1").value.trim();
      const pareja2 = document.getElementById("pareja2").value.trim();
      const puntos1 = parseInt(document.getElementById("puntos1").value);
      const puntos2 = parseInt(document.getElementById("puntos2").value);

      if (!pareja1 || !pareja2 || isNaN(puntos1) || isNaN(puntos2)) {
        alert("Por favor, completÃ¡ todos los campos.");
        return;
      }

      actualizarTabla(pareja1, puntos1, puntos2);
      actualizarTabla(pareja2, puntos2, puntos1);
      mostrarTabla();
      mostrarIndividual();
    }

    function actualizarTabla(pareja, puntosPropios, puntosRivales) {
      if (!tablaParejas[pareja]) {
        tablaParejas[pareja] = {
          jugados: 0,
          ganados: 0,
          empatados: 0,
          perdidos: 0,
          puntos: 0
        };
      }

      const stats = tablaParejas[pareja];
      stats.jugados++;

      if (puntosPropios > puntosRivales) {
        stats.ganados++;
        stats.puntos += 3;
      } else if (puntosPropios === puntosRivales) {
        stats.empatados++;
        stats.puntos += 1;
      } else {
        stats.perdidos++;
      }
    }

    function mostrarTabla() {
      const tbody = document.querySelector("#tabla-parejas tbody");
      tbody.innerHTML = "";

      Object.entries(tablaParejas).forEach(([pareja, stats]) => {
        const fila = document.createElement("tr");
        fila.innerHTML = `
          <td>${pareja}</td>
          <td>${stats.jugados}</td>
          <td>${stats.ganados}</td>
          <td>${stats.empatados}</td>
          <td>${stats.perdidos}</td>
          <td>${stats.puntos}</td>
        `;
        tbody.appendChild(fila);
      });
    }

    function mostrarIndividual() {
      const puntosJugadores = {};

      Object.entries(tablaParejas).forEach(([pareja, stats]) => {
        const jugadores = pareja.split(" y ");
        jugadores.forEach(j => {
          if (!puntosJugadores[j]) puntosJugadores[j] = 0;
          puntosJugadores[j] += stats.puntos / 2;
        });
      });

      const tbody = document.querySelector("#tabla-individual tbody");
      tbody.innerHTML = "";

      Object.entries(puntosJugadores).forEach(([jugador, puntos]) => {
        const fila = document.createElement("tr");
        fila.innerHTML = `
          <td>${jugador}</td>
          <td>${puntos}</td>
        `;
        tbody.appendChild(fila);
      });
    }

    function guardarHistorial() {
      let historial = JSON.parse(localStorage.getItem("historialParejas") || "[]");

      Object.entries(tablaParejas).forEach(([pareja, stats]) => {
        const existente = historial.find(p => p.pareja === pareja);
        if (existente) {
          existente.jugados += stats.jugados;
          existente.ganados += stats.ganados;
          existente.empatados += stats.empatados;
          existente.perdidos += stats.perdidos;
          existente.puntos += stats.puntos;
        } else {
          historial.push({ pareja, ...stats });
        }
      });

      localStorage.setItem("historialParejas", JSON.stringify(historial));
      alert("Historial guardado correctamente.");
    }
  </script>
</body>
</html>